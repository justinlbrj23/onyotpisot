workflow:
  name: tssf-existing-sheet-setup
  version: 1.1

  environment:
    runtime: nodejs
    node_version: "18+"
    credentials:
      google_service_account: service-account.json

  parameters:
    spreadsheet_id: 1CsLXhlNp9pP9dAVBpGFvEnw1PpuUvLfypFg56RrgjxA
    sheet_name: Sheet1

  steps:
    - id: init
      action: system.log
      message: "Organizing headers for existing TSSF Google Sheet"

    - id: write_headers
      action: node.execute
      script: organize_tssf_headers.js

    - id: freeze_header
      action: sheets.format
      properties:
        freeze_rows: 1

    - id: validate
      action: sheets.validate
      rules:
        required_headers:
          - State
          - County
          - Property Address
          - Auction Date
          - Sale Price
          - Opening / Minimum Bid
          - Estimated Surplus
          - Deal Viable? (Yes/No)
          - File Complete? (Yes/No)
          - Accepted / Rejected

    - id: done
      action: system.log
      message: "TSSF sheet structure finalized"